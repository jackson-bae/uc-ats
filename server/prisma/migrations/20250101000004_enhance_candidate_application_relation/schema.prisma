// This file shows the enhanced candidate-application relationship
// The actual schema changes are in the migration.sql file

model Candidate {
  id                String   @id @default(uuid())
  studentId         Int      @unique
  firstName         String
  lastName          String
  email             String   @unique
  assignedGroupId   String?
  createdAt         DateTime @default(now())
  updatedAt         DateTime @updatedAt

  // Relations
  applications      Application[]  // All applications for this candidate
  resumeScores      ResumeScore[]
  coverLetterScores CoverLetterScore[]
  videoScores       VideoScore[]
  eventRsvp         EventRsvp[]
  eventAttendance   EventAttendance[]
  coffeeChat        CoffeeChat[]
  roundOne          RoundOne[]
  roundTwo          RoundTwo[]
  referrals         Referral[]
  
  // Group assignment relation
  assignedGroup     Groups? @relation(fields: [assignedGroupId], references: [id])

  @@map("candidates")
}

model Application {
  id                    String              @id @default(uuid())
  status                ApplicationStatus   @default(SUBMITTED)

  responseID            String              @unique
  submittedAt           DateTime            @default(now())

  email                 String              
  firstName             String
  lastName              String
  studentId             String              
  phoneNumber           String

  graduationYear        String
  isTransferStudent     Boolean
  priorCollegeYears     String?
  cumulativeGpa         Decimal            @db.Decimal(3,2)
  majorGpa              Decimal            @db.Decimal(3,2)
  major1                String
  major2                String?

  gender                String?
  isFirstGeneration     Boolean

  resumeUrl             String             
  blindResumeUrl        String?             
  headshotUrl           String             
  coverLetterUrl        String?             
  videoUrl              String?             

  rawResponses          Json

  @@map("applications")

  approved              Boolean?
  currentRound          String?

  // Recruiting cycle relation
  cycleId               String?
  cycle                 RecruitingCycle?    @relation(fields: [cycleId], references: [id])

  // Enhanced Candidate relation - now required and automatically linked
  candidateId           String              // Changed from String? to String (required)
  candidate             Candidate           @relation(fields: [candidateId], references: [id]) // Changed from Candidate? to Candidate (required)

  comments              Comment[]
}
